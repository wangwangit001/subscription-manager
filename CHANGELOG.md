# 更新日志

## v2.0.0 - 2025-07-06

### 🎉 新功能

#### 1. 农历日期显示
- ✅ 在订阅列表中显示农历日期
- ✅ 支持1900-2100年的农历转换
- ✅ 在通知消息中包含农历信息
- ✅ 显示天干地支年份格式

#### 2. 多渠道通知支持
- ✅ 支持同时选择多个推送渠道
- ✅ 可同时启用 Telegram、NotifyX、自定义Webhook
- ✅ 触发时会向所有启用的渠道发送通知
- ✅ 每个渠道独立配置和测试

#### 3. 自定义Webhook通知
- ✅ 支持自定义请求URL
- ✅ 支持GET/POST/PUT请求方法
- ✅ 支持自定义请求头（JSON格式）
- ✅ 支持自定义消息模板
- ✅ 支持变量替换：{{title}}, {{content}}, {{timestamp}}

#### 4. 第三方API接口
- ✅ 新增 `/api/notify/{code}` 接口
- ✅ 支持POST请求发送通知
- ✅ 支持title和content参数
- ✅ 自动发送到所有启用的通知渠道

### 🔧 改进

#### 配置保存优化
- ✅ 修复配置保存失败的问题
- ✅ 增加详细的错误信息提示
- ✅ 优化错误处理逻辑

#### 用户体验提升
- ✅ 配置页面支持多选通知方式
- ✅ 实时显示启用/禁用的配置区域
- ✅ 优化农历日期显示样式

### 📝 使用说明

#### 农历日期功能
- 农历日期会自动显示在订阅列表的到期时间下方
- 格式：农历: 乙巳年六月十二
- 支持闰月显示

#### 多渠道通知配置
1. 进入系统配置页面
2. 在"通知方式"区域勾选需要的渠道
3. 配置对应渠道的参数
4. 点击测试按钮验证配置
5. 保存配置

#### 自定义Webhook配置
```json
// 自定义请求头示例
{
  "Authorization": "Bearer your-token",
  "Content-Type": "application/json",
  "X-Custom-Header": "value"
}

// 自定义消息模板示例
{
  "title": "{{title}}",
  "content": "{{content}}",
  "timestamp": "{{timestamp}}",
  "source": "subscription-manager"
}
```

#### 第三方API使用
```bash
# 发送通知示例
curl -X POST "https://your-domain.com/api/notify/your-code" \
  -H "Content-Type: application/json" \
  -d '{
    "title": "服务器告警",
    "content": "CPU使用率超过90%，请及时处理！\n\n**详细信息**：\n- 服务器：web-server-01\n- 时间：2023-09-15 14:30:45\n- 当前负载：95%"
  }'
```

### 🐛 修复
- 修复配置保存时的错误处理
- 修复多渠道通知的逻辑问题
- 优化农历转换的性能

### ⚠️ 注意事项
- 升级后需要重新配置通知渠道（从单选改为多选）
- 农历转换仅支持1900-2100年范围
- Webhook配置的JSON格式必须正确
- 第三方API的code参数当前版本暂未实现验证机制

### 🔄 兼容性
- 完全向后兼容现有配置
- 自动迁移旧版本的通知配置
- 保持原有API接口不变
